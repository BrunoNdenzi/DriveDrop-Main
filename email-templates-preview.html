<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DriveDrop Email Templates Preview</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f5f5;
      padding: 20px;
      margin: 0;
    }
    .preview-container {
      max-width: 1400px;
      margin: 0 auto;
    }
    h1 {
      text-align: center;
      color: #00B8A9;
      margin-bottom: 40px;
    }
    .email-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
      gap: 30px;
      margin-bottom: 40px;
    }
    .email-preview {
      background: white;
      border-radius: 10px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    .email-header {
      background: #00B8A9;
      color: white;
      padding: 20px;
      text-align: center;
    }
    .email-header h2 {
      margin: 0;
      font-size: 18px;
    }
    .email-body {
      padding: 20px;
    }
    iframe {
      width: 100%;
      height: 800px;
      border: none;
      display: block;
    }
    .features {
      background: white;
      border-radius: 10px;
      padding: 30px;
      margin-top: 30px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    .features h2 {
      color: #00B8A9;
      margin-top: 0;
    }
    .feature-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    .feature-item {
      background: #f9f9f9;
      padding: 15px;
      border-radius: 8px;
      border-left: 4px solid #00B8A9;
    }
    .feature-item h3 {
      margin: 0 0 10px 0;
      color: #333;
      font-size: 16px;
    }
    .feature-item ul {
      margin: 0;
      padding-left: 20px;
    }
    .feature-item li {
      margin: 5px 0;
      font-size: 14px;
      color: #666;
    }
    .stats {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 20px;
      margin-top: 30px;
    }
    .stat-card {
      background: linear-gradient(135deg, #00B8A9 0%, #008B80 100%);
      color: white;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
    }
    .stat-card h3 {
      margin: 0;
      font-size: 36px;
      font-weight: bold;
    }
    .stat-card p {
      margin: 5px 0 0 0;
      font-size: 14px;
      opacity: 0.9;
    }
    .code-block {
      background: #2d2d2d;
      color: #f8f8f2;
      padding: 20px;
      border-radius: 8px;
      overflow-x: auto;
      font-family: 'Courier New', monospace;
      font-size: 13px;
      margin: 20px 0;
    }
    .button {
      display: inline-block;
      background: #00B8A9;
      color: white;
      padding: 12px 30px;
      text-decoration: none;
      border-radius: 8px;
      font-weight: bold;
      margin: 10px 5px;
    }
    .button:hover {
      background: #008B80;
    }
  </style>
</head>
<body>
  <div class="preview-container">
    <h1>üìß DriveDrop Invoice/Receipt Email Templates</h1>
    
    <!-- Stats -->
    <div class="stats">
      <div class="stat-card">
        <h3>3</h3>
        <p>Email Templates</p>
      </div>
      <div class="stat-card">
        <h3>100%</h3>
        <p>Mobile Responsive</p>
      </div>
      <div class="stat-card">
        <h3>2</h3>
        <p>Payment Events</p>
      </div>
      <div class="stat-card">
        <h3>7</h3>
        <p>Pricing Factors</p>
      </div>
    </div>

    <!-- Features Overview -->
    <div class="features">
      <h2>‚ú® Key Features</h2>
      <div class="feature-list">
        <div class="feature-item">
          <h3>üé® Professional Design</h3>
          <ul>
            <li>Teal gradient headers</li>
            <li>Clean, modern layout</li>
            <li>Branded with DriveDrop colors</li>
            <li>Mobile-responsive</li>
          </ul>
        </div>
        <div class="feature-item">
          <h3>üí∞ Detailed Pricing</h3>
          <ul>
            <li>All 7 pricing factors shown</li>
            <li>Distance bands (short/mid/long)</li>
            <li>Fuel adjustments</li>
            <li>Bulk discounts</li>
          </ul>
        </div>
        <div class="feature-item">
          <h3>üì± Multi-Format</h3>
          <ul>
            <li>HTML version with styling</li>
            <li>Plain text fallback</li>
            <li>Email client compatible</li>
            <li>Inline CSS</li>
          </ul>
        </div>
        <div class="feature-item">
          <h3>üîê Secure & Compliant</h3>
          <ul>
            <li>Only last 4 digits shown</li>
            <li>Receipt numbers tracked</li>
            <li>Database logging</li>
            <li>GDPR compliant</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Email Templates Grid -->
    <div class="email-grid" style="margin-top: 40px;">
      <!-- Booking Confirmation -->
      <div class="email-preview">
        <div class="email-header">
          <h2>1Ô∏è‚É£ Booking Confirmation Email</h2>
          <p style="margin: 5px 0 0 0; font-size: 14px;">Sent after 20% payment capture</p>
        </div>
        <div class="email-body">
          <h3 style="margin-top: 0; color: #00B8A9;">‚úÖ Features:</h3>
          <ul style="line-height: 1.8;">
            <li><strong>Teal gradient header</strong> with receipt number</li>
            <li><strong>Complete shipment details:</strong> route, vehicle, dates</li>
            <li><strong>Detailed pricing breakdown table</strong> with all 7 factors:
              <ul>
                <li>Distance & band (short/mid/long)</li>
                <li>Base rate per mile</li>
                <li>Delivery speed multiplier</li>
                <li>Fuel adjustment %</li>
                <li>Bulk discounts</li>
              </ul>
            </li>
            <li><strong>Payment split visualization:</strong> 20% charged ‚úì / 80% reserved ‚è≥</li>
            <li><strong>"What's Next?"</strong> section with 5-step guide</li>
            <li><strong>"Track Shipment"</strong> button links to dashboard</li>
            <li>Mobile-responsive + plain text version</li>
          </ul>

          <div style="background: #e8f5f4; padding: 15px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #00B8A9;">
            <strong>Example Subject:</strong><br>
            <code style="background: white; padding: 3px 6px; border-radius: 4px; font-size: 13px;">
              ‚úÖ Booking Confirmed - Shipment #12345 | DriveDrop
            </code>
          </div>

          <div style="background: #fff3cd; padding: 15px; border-radius: 8px; border-left: 4px solid #ffc107;">
            <strong>üí° Receipt Format:</strong> DD-{shipmentId}-01
          </div>
        </div>
      </div>

      <!-- Delivery Receipt -->
      <div class="email-preview">
        <div class="email-header" style="background: linear-gradient(135deg, #28a745 0%, #218838 100%);">
          <h2>2Ô∏è‚É£ Delivery Receipt Email</h2>
          <p style="margin: 5px 0 0 0; font-size: 14px;">Sent after 80% payment capture</p>
        </div>
        <div class="email-body">
          <h3 style="margin-top: 0; color: #28a745;">üéâ Features:</h3>
          <ul style="line-height: 1.8;">
            <li><strong>Green gradient header</strong> (success theme)</li>
            <li><strong>Delivery confirmation:</strong> date, time, driver name</li>
            <li><strong>Complete payment summary:</strong>
              <ul>
                <li>Total amount</li>
                <li>20% upfront (with date)</li>
                <li>80% final (with date)</li>
                <li>"Payment Complete" badge</li>
              </ul>
            </li>
            <li><strong>Route visualization</strong> with pickup ‚Üí delivery icons</li>
            <li><strong>Link to delivery photos</strong> (if available)</li>
            <li><strong>Feedback request</strong> for driver rating</li>
            <li><strong>"View Shipment Details"</strong> button</li>
            <li>Mobile-responsive + plain text version</li>
          </ul>

          <div style="background: #f0fff4; padding: 15px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #28a745;">
            <strong>Example Subject:</strong><br>
            <code style="background: white; padding: 3px 6px; border-radius: 4px; font-size: 13px;">
              üéâ Delivery Complete - Receipt for Shipment #12345 | DriveDrop
            </code>
          </div>

          <div style="background: #d1ecf1; padding: 15px; border-radius: 8px; border-left: 4px solid #17a2b8;">
            <strong>‚ÑπÔ∏è Sent To:</strong> Client (final receipt)<br>
            <strong>Receipt Format:</strong> DD-{shipmentId}-02
          </div>
        </div>
      </div>

      <!-- Driver Payout -->
      <div class="email-preview">
        <div class="email-header" style="background: linear-gradient(135deg, #28a745 0%, #218838 100%);">
          <h2>3Ô∏è‚É£ Driver Payout Notification</h2>
          <p style="margin: 5px 0 0 0; font-size: 14px;">Sent to driver after delivery</p>
        </div>
        <div class="email-body">
          <h3 style="margin-top: 0; color: #28a745;">üí∞ Features:</h3>
          <ul style="line-height: 1.8;">
            <li><strong>Green gradient header</strong> (earnings theme)</li>
            <li><strong>Earnings breakdown:</strong>
              <ul>
                <li>Total shipment value</li>
                <li>Platform fee (20%)</li>
                <li><strong>Net payout (80%)</strong> in HUGE green text</li>
              </ul>
            </li>
            <li><strong>Payout details:</strong>
              <ul>
                <li>Method: Stripe Connect</li>
                <li>Expected timeline: 2-5 business days</li>
                <li>Delivery completion date</li>
              </ul>
            </li>
            <li><strong>Info banner</strong> explaining payment processing</li>
            <li><strong>"Keep Driving!"</strong> motivational section</li>
            <li>Professional, encouraging tone</li>
            <li>Mobile-responsive + plain text version</li>
          </ul>

          <div style="background: #f0fff4; padding: 15px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #28a745;">
            <strong>Example Subject:</strong><br>
            <code style="background: white; padding: 3px 6px; border-radius: 4px; font-size: 13px;">
              üí∞ Payout Confirmed - $1,022.96 | DriveDrop
            </code>
          </div>

          <div style="background: #fff3cd; padding: 15px; border-radius: 8px; border-left: 4px solid #ffc107;">
            <strong>‚ö†Ô∏è Note:</strong> Sent simultaneously with client delivery receipt
          </div>
        </div>
      </div>
    </div>

    <!-- Email Flow Diagram -->
    <div class="features">
      <h2>üîÑ Email Flow</h2>
      <div style="background: #f9f9f9; padding: 30px; border-radius: 8px; margin-top: 20px;">
        <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 20px; align-items: center;">
          <!-- Booking Flow -->
          <div style="background: white; padding: 20px; border-radius: 8px; border-left: 4px solid #00B8A9;">
            <h3 style="margin: 0 0 15px 0; color: #00B8A9;">üì¶ Booking Flow</h3>
            <ol style="margin: 0; padding-left: 20px; line-height: 1.8;">
              <li>User creates shipment</li>
              <li>20% payment captured</li>
              <li><strong>‚úâÔ∏è Booking confirmation sent</strong></li>
              <li>Receipt: DD-{id}-01</li>
              <li>Flag: upfront_payment_sent = true</li>
            </ol>
          </div>

          <div style="font-size: 48px; color: #00B8A9;">‚Üí</div>

          <!-- Delivery Flow -->
          <div style="background: white; padding: 20px; border-radius: 8px; border-left: 4px solid #28a745;">
            <h3 style="margin: 0 0 15px 0; color: #28a745;">üéâ Delivery Flow</h3>
            <ol style="margin: 0; padding-left: 20px; line-height: 1.8;">
              <li>Driver confirms delivery</li>
              <li>80% payment captured</li>
              <li><strong>‚úâÔ∏è Delivery receipt ‚Üí Client</strong></li>
              <li><strong>‚úâÔ∏è Payout notification ‚Üí Driver</strong></li>
              <li>Receipt: DD-{id}-02</li>
              <li>Flags: final_receipt_sent & driver_payout_notified = true</li>
            </ol>
          </div>
        </div>
      </div>
    </div>

    <!-- Pricing Breakdown Example -->
    <div class="features">
      <h2>üíµ Pricing Breakdown Example</h2>
      <div style="background: white; padding: 20px; border-radius: 8px; margin-top: 20px; border: 1px solid #ddd;">
        <h3 style="margin: 0 0 15px 0; color: #00B8A9;">Dallas ‚Üí San Diego (1,346 miles)</h3>
        
        <table style="width: 100%; border-collapse: collapse; font-size: 14px;">
          <tr style="border-bottom: 1px solid #eee;">
            <td style="padding: 12px 0; color: #666;">Distance</td>
            <td style="padding: 12px 0; text-align: right; font-weight: bold;">1,346 miles</td>
          </tr>
          <tr style="border-bottom: 1px solid #eee;">
            <td style="padding: 12px 0; color: #666;">Vehicle Type</td>
            <td style="padding: 12px 0; text-align: right;">Sedan</td>
          </tr>
          <tr style="border-bottom: 1px solid #eee;">
            <td style="padding: 12px 0; color: #666;">Distance Band</td>
            <td style="padding: 12px 0; text-align: right;">Mid-distance (501-1500 mi)</td>
          </tr>
          <tr style="border-bottom: 1px solid #eee;">
            <td style="padding: 12px 0; color: #666;">Base Rate</td>
            <td style="padding: 12px 0; text-align: right;">$0.95/mile</td>
          </tr>
          <tr style="border-bottom: 1px solid #eee;">
            <td style="padding: 12px 0; color: #666;">Raw Price</td>
            <td style="padding: 12px 0; text-align: right;">$1,278.70</td>
          </tr>
          <tr style="border-bottom: 1px solid #eee;">
            <td style="padding: 12px 0; color: #666;">Delivery Speed</td>
            <td style="padding: 12px 0; text-align: right;">Standard (1.0x)</td>
          </tr>
          <tr style="border-bottom: 1px solid #eee;">
            <td style="padding: 12px 0; color: #666;">Fuel Adjustment</td>
            <td style="padding: 12px 0; text-align: right;">+0% ($3.70/gal)</td>
          </tr>
          <tr style="border-bottom: 3px solid #00B8A9; background: #f0fffe;">
            <td style="padding: 15px 0; font-weight: bold; font-size: 18px;">TOTAL</td>
            <td style="padding: 15px 0; text-align: right; font-weight: bold; font-size: 24px; color: #00B8A9;">$1,278.70</td>
          </tr>
        </table>

        <div style="margin-top: 20px; padding: 15px; background: #e8f5f4; border-radius: 8px;">
          <table style="width: 100%; border-collapse: collapse; font-size: 14px;">
            <tr>
              <td style="padding: 8px 0; color: #666;">Upfront Payment (20%)</td>
              <td style="padding: 8px 0; text-align: right; font-weight: bold; color: #28a745;">$255.74 ‚úì Charged</td>
            </tr>
            <tr>
              <td style="padding: 8px 0; color: #666;">Remaining (80%)</td>
              <td style="padding: 8px 0; text-align: right; font-weight: bold;">$1,022.96 ‚è≥ Reserved</td>
            </tr>
          </table>
        </div>
      </div>
    </div>

    <!-- Technical Details -->
    <div class="features">
      <h2>üîß Technical Details</h2>
      <div class="feature-list">
        <div class="feature-item">
          <h3>üìÅ Files Modified</h3>
          <ul>
            <li><code>email.service.ts</code> - Added 3 functions</li>
            <li><code>add_email_tracking.sql</code> - Database schema</li>
          </ul>
        </div>
        <div class="feature-item">
          <h3>üìä Database Tables</h3>
          <ul>
            <li><code>payment_receipts</code> - Receipt tracking</li>
            <li><code>shipments</code> - Email sent flags</li>
          </ul>
        </div>
        <div class="feature-item">
          <h3>üîê Security</h3>
          <ul>
            <li>Row Level Security enabled</li>
            <li>Only last 4 digits shown</li>
            <li>Receipt numbers tracked</li>
          </ul>
        </div>
        <div class="feature-item">
          <h3>üìß Delivery</h3>
          <ul>
            <li>Primary: Brevo API</li>
            <li>Fallback: Gmail SMTP</li>
            <li>HTML + plain text versions</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Quick Start -->
    <div class="features">
      <h2>üöÄ Quick Start</h2>
      <p style="margin-bottom: 20px;">Deploy the email system in 3 steps:</p>
      
      <div style="background: #f9f9f9; padding: 20px; border-radius: 8px; margin-bottom: 15px;">
        <h3 style="margin: 0 0 10px 0; color: #00B8A9;">1Ô∏è‚É£ Run Database Migration</h3>
        <div class="code-block" style="margin: 10px 0 0 0;">
psql -h [SUPABASE_HOST] -U postgres -d postgres -f migrations/add_email_tracking.sql
        </div>
      </div>

      <div style="background: #f9f9f9; padding: 20px; border-radius: 8px; margin-bottom: 15px;">
        <h3 style="margin: 0 0 10px 0; color: #00B8A9;">2Ô∏è‚É£ Deploy Backend Code</h3>
        <div class="code-block" style="margin: 10px 0 0 0;">
git add backend/src/services/email.service.ts
git commit -m "Add invoice/receipt email templates"
git push origin main
        </div>
      </div>

      <div style="background: #f9f9f9; padding: 20px; border-radius: 8px;">
        <h3 style="margin: 0 0 10px 0; color: #00B8A9;">3Ô∏è‚É£ Test Email Delivery</h3>
        <div class="code-block" style="margin: 10px 0 0 0;">
# Send test booking confirmation
curl -X POST https://your-api.com/api/test/booking-email \
  -H "Content-Type: application/json"
        </div>
      </div>
    </div>

    <!-- Call to Action -->
    <div style="text-align: center; margin: 50px 0; padding: 40px; background: linear-gradient(135deg, #00B8A9 0%, #008B80 100%); border-radius: 10px; color: white;">
      <h2 style="margin: 0 0 20px 0; font-size: 32px;">Email System Ready! üéâ</h2>
      <p style="margin: 0 0 30px 0; font-size: 18px;">All templates are built and ready for integration with your payment flow.</p>
      <a href="#" class="button" style="background: white; color: #00B8A9; margin: 0 10px;">View Integration Guide</a>
      <a href="#" class="button" style="background: #28a745; color: white; margin: 0 10px;">Run Database Migration</a>
    </div>

    <!-- Footer -->
    <div style="text-align: center; padding: 30px; color: #666; border-top: 1px solid #ddd;">
      <p style="margin: 0; font-size: 14px;">
        üìß Email Templates by <strong style="color: #00B8A9;">DriveDrop</strong> | 
        Built with ‚ù§Ô∏è for professional vehicle transport
      </p>
      <p style="margin: 10px 0 0 0; font-size: 12px;">
        For support, check <code>INVOICE_EMAIL_INTEGRATION_GUIDE.md</code>
      </p>
    </div>
  </div>
</body>
</html>
