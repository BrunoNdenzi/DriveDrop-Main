# ğŸ“Š Visual Diagrams - Pickup Verification System

---

## 1. Complete Status Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SHIPMENT LIFECYCLE                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CLIENT BOOKS SHIPMENT
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ PENDING â”‚ â† Waiting for driver
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Driver accepts OR Admin assigns
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ACCEPTED â”‚ â† Driver assigned
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Driver clicks "Start Trip"
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DRIVER_EN_ROUTE  â”‚ â† GPS tracking active
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Driver clicks "I've Arrived" + GPS check (â‰¤100m)
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DRIVER_ARRIVED   â”‚ â† Driver at location
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Driver clicks "Start Verification"
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PICKUP_VERIFICATION_PENDING    â”‚ â† Taking photos (6 minimum)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ Driver submits decision
             â”‚
        â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                 â”‚
        â–¼                 â–¼
    âœ… MATCHES      âš ï¸ MINOR         âŒ MAJOR
        â”‚           DIFFERENCES       ISSUES
        â”‚                â”‚              â”‚
        â”‚           â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”        â”‚
        â”‚           â–¼         â–¼         â”‚
        â”‚      CLIENT     CLIENT       â”‚
        â”‚      APPROVES   DISPUTES     â”‚
        â”‚           â”‚         â”‚         â”‚
        â”‚           â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚           â”‚                   â”‚
        â”‚           â”‚              â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
        â”‚           â”‚              â”‚CANCELLEDâ”‚
        â”‚           â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚           â”‚              Refund: 70%
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
                           â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚ PICKUP_VERIFIED  â”‚ â† Ready to load
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ Driver clicks "Mark as Picked Up"
                            â”‚
                            â–¼
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚ PICKED_UP   â”‚ â† Vehicle loaded & secured
                     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ Driver clicks "Start Delivery"
                            â”‚
                            â–¼
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚  IN_TRANSIT  â”‚ â† Active delivery
                     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ Driver uploads delivery photos
                            â”‚
                            â–¼
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚  DELIVERED  â”‚ â† Payment released
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. Verification Decision Tree

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         DRIVER COMPLETES PHOTO COMPARISON                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ SELECT DECISION â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚              â”‚              â”‚
            â–¼              â–¼              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  âœ… MATCHES  â”‚ â”‚ âš ï¸ MINOR     â”‚ â”‚ âŒ MAJOR     â”‚
    â”‚              â”‚ â”‚ DIFFERENCES  â”‚ â”‚ ISSUES       â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                â”‚                â”‚
           â”‚                â”‚                â”‚
           â–¼                â–¼                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Auto-approve  â”‚ â”‚Alert client  â”‚ â”‚Auto-cancel   â”‚
    â”‚              â”‚ â”‚              â”‚ â”‚              â”‚
    â”‚Status:       â”‚ â”‚5-min timer   â”‚ â”‚Status:       â”‚
    â”‚pickup_       â”‚ â”‚starts        â”‚ â”‚cancelled     â”‚
    â”‚verified      â”‚ â”‚              â”‚ â”‚              â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                â”‚                â”‚
           â”‚           â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”          â”‚
           â”‚           â–¼         â–¼           â”‚
           â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
           â”‚      â”‚APPROVED â”‚ â”‚DISPUTED â”‚  â”‚
           â”‚      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â”‚
           â”‚           â”‚           â”‚        â”‚
           â”‚           â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¤
           â”‚           â”‚                    â”‚
           â–¼           â–¼                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚     PROCEED WITH PICKUP      â”‚ â”‚   CANCELLED     â”‚
    â”‚                              â”‚ â”‚                 â”‚
    â”‚ â€¢ Driver loads vehicle       â”‚ â”‚ â€¢ Refund client â”‚
    â”‚ â€¢ Marks as "picked_up"       â”‚ â”‚ â€¢ Pay driver    â”‚
    â”‚ â€¢ Starts delivery            â”‚ â”‚ â€¢ Close shipmentâ”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. GPS Verification Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 DRIVER ARRIVAL VERIFICATION                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   Driver clicks "I've Arrived"
           â”‚
           â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Get GPS coords â”‚
   â”‚ lat, lng, acc  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Get pickup address  â”‚
   â”‚ coordinates from DB â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Calculate distance     â”‚
   â”‚ using Haversine formulaâ”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
        â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
        â”‚ Distance? â”‚
        â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
              â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                â”‚
      â–¼                â–¼
   â‰¤ 100m          > 100m
      â”‚                â”‚
      â–¼                â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ SUCCESS â”‚    â”‚ ERROR                   â”‚
   â”‚         â”‚    â”‚ "You must be within     â”‚
   â”‚ Update  â”‚    â”‚ 100 meters. Current:    â”‚
   â”‚ status  â”‚    â”‚ 250m"                   â”‚
   â”‚ to      â”‚    â”‚                         â”‚
   â”‚ driver_ â”‚    â”‚ Retry allowed           â”‚
   â”‚ arrived â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
        â”‚
        â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Set driver_arrival_ â”‚
   â”‚ time to NOW()       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Send notification to   â”‚
   â”‚ client: "Driver has    â”‚
   â”‚ arrived"               â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. Photo Upload Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PHOTO UPLOAD PROCESS                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   Driver takes photo
           â”‚
           â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Select angle   â”‚
   â”‚ (front, rear,  â”‚
   â”‚  side, etc.)   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Validate image     â”‚
   â”‚ â€¢ Size < 5MB       â”‚
   â”‚ â€¢ Type: jpg/png    â”‚
   â”‚ â€¢ Angle required   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
        â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
        â”‚  Valid?   â”‚
        â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
              â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                â”‚
      â–¼                â–¼
    YES              NO
      â”‚                â”‚
      â”‚                â–¼
      â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚        â”‚ Show error  â”‚
      â”‚        â”‚ â€¢ Size limitâ”‚
      â”‚        â”‚ â€¢ Invalid   â”‚
      â”‚        â”‚   type      â”‚
      â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Upload to Supabase     â”‚
   â”‚ Storage                â”‚
   â”‚                        â”‚
   â”‚ Path: pickup-          â”‚
   â”‚ verifications/         â”‚
   â”‚ {verificationId}/      â”‚
   â”‚ {angle}_{timestamp}.jpgâ”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Get public URL         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Update verification    â”‚
   â”‚ record                 â”‚
   â”‚ â€¢ Add photo to JSONB   â”‚
   â”‚ â€¢ Increment photo_countâ”‚
   â”‚ â€¢ Save GPS coords      â”‚
   â”‚ â€¢ Save timestamp       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Update UI              â”‚
   â”‚ â€¢ Show thumbnail       â”‚
   â”‚ â€¢ Update progress:     â”‚
   â”‚   "3 of 6 photos"      â”‚
   â”‚ â€¢ Enable submit if â‰¥6  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. Refund Calculation Matrix

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   CANCELLATION SCENARIOS                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Original Amount: $500.00

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Cancellation Type       â”‚  Client  â”‚ Driver  â”‚ Platform â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Before Acceptance       â”‚ $500 100%â”‚  $0  0% â”‚  $0   0% â”‚
â”‚                         â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚         â”‚          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ After Accept,           â”‚ $400  80%â”‚ $50 10% â”‚ $50  10% â”‚
â”‚ Before Pickup           â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â”‚  â–ˆ      â”‚  â–ˆ       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ At Pickup - Mismatch    â”‚ $350  70%â”‚$100 20% â”‚ $50  10% â”‚
â”‚                         â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â”‚  â–ˆâ–ˆ     â”‚  â–ˆ       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ At Pickup - FRAUD       â”‚   $0   0%â”‚$200 40% â”‚$300  60% â”‚
â”‚ âš ï¸ Confirmed Fraud      â”‚          â”‚  â–ˆâ–ˆâ–ˆâ–ˆ   â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ During Transit          â”‚ $250  50%â”‚$200 40% â”‚ $50  10% â”‚
â”‚                         â”‚  â–ˆâ–ˆâ–ˆâ–ˆ    â”‚  â–ˆâ–ˆâ–ˆâ–ˆ   â”‚  â–ˆ       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Force Majeure           â”‚ $450  90%â”‚ $25  5% â”‚ $25   5% â”‚
â”‚ (Weather, emergency)    â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â”‚  â–ˆ      â”‚  â–ˆ       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. Client Response Timeline

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         CLIENT NOTIFICATION & RESPONSE TIMELINE                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Driver finds minor differences
           â”‚
           â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Push notification  â”‚ â† Instant
   â”‚ SMS alert          â”‚ â† Within 10 seconds
   â”‚ Email              â”‚ â† Within 1 minute
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ 5:00    â”‚ â† Timer starts
        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
             â”‚
             â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ 4:00    â”‚
        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
             â”‚
             â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ 3:00    â”‚ â† Reminder notification
        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
             â”‚
             â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ 2:00    â”‚
        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
             â”‚
             â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ 1:00    â”‚ â† Final warning
        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
             â”‚
             â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ 0:00    â”‚ â† Time's up
        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
             â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
      â”‚              â”‚
      â–¼              â–¼
 CLIENT          NO RESPONSE
 RESPONDED
      â”‚              â”‚
      â”‚              â–¼
      â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚      â”‚AUTO-APPROVE  â”‚
      â”‚      â”‚              â”‚
      â”‚      â”‚"Client did   â”‚
      â”‚      â”‚not respond   â”‚
      â”‚      â”‚within 5 min" â”‚
      â”‚      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚             â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â–¼
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚PICKUP_VERIFIEDâ”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. Database Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   DATABASE SCHEMA DIAGRAM                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   profiles   â”‚           â”‚      shipments       â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚           â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ id (PK)      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ client_id (FK)       â”‚
â”‚ email        â”‚           â”‚ driver_id (FK)       â”‚
â”‚ role         â”‚     â”Œâ”€â”€â”€â”€â–ºâ”‚ id (PK)              â”‚
â”‚ ...          â”‚     â”‚     â”‚ status               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚     â”‚ pickup_address       â”‚
                     â”‚     â”‚ pickup_lat/lng       â”‚
                     â”‚     â”‚ driver_arrival_time  â”‚
                     â”‚     â”‚ pickup_verified      â”‚
                     â”‚     â”‚ pickup_verified_at   â”‚
                     â”‚     â”‚ actual_pickup_time   â”‚
                     â”‚     â”‚ cancellation_record_idâ”‚
                     â”‚     â”‚ ...                  â”‚
                     â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚              â”‚
                     â”‚              â”‚ 1:1
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”       â”‚
        â”‚                   â”‚       â–¼
        â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚         â”‚   pickup_verifications      â”‚
        â”‚         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
        â”‚         â”‚ id (PK)                     â”‚
        â”‚         â”‚ shipment_id (FK)            â”‚
        â”‚         â”‚ driver_id (FK)              â”‚
        â”‚         â”‚ driver_photos (JSONB[])     â”‚
        â”‚         â”‚ photo_count                 â”‚
        â”‚         â”‚ decision                    â”‚
        â”‚         â”‚ differences (JSONB[])       â”‚
        â”‚         â”‚ driver_notes                â”‚
        â”‚         â”‚ verification_location       â”‚
        â”‚         â”‚ distance_from_pickup_meters â”‚
        â”‚         â”‚ client_response             â”‚
        â”‚         â”‚ client_notes                â”‚
        â”‚         â”‚ client_responded_at         â”‚
        â”‚         â”‚ status                      â”‚
        â”‚         â”‚ verification_completed_at   â”‚
        â”‚         â”‚ ...                         â”‚
        â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                       â”‚
        â”‚                       â”‚ 1:1
        â”‚                       â”‚
        â”‚                       â–¼
        â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â””â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   cancellation_records      â”‚
                  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
                  â”‚ id (PK)                     â”‚
                  â”‚ shipment_id (FK)            â”‚
                  â”‚ pickup_verification_id (FK) â”‚
                  â”‚ initiated_by                â”‚
                  â”‚ initiator_id                â”‚
                  â”‚ cancellation_type           â”‚
                  â”‚ reason                      â”‚
                  â”‚ fraud_confirmed             â”‚
                  â”‚ original_amount             â”‚
                  â”‚ refund_to_client            â”‚
                  â”‚ compensation_to_driver      â”‚
                  â”‚ platform_fee                â”‚
                  â”‚ processing_fee              â”‚
                  â”‚ refund_status               â”‚
                  â”‚ refund_processed_at         â”‚
                  â”‚ stripe_refund_id            â”‚
                  â”‚ stripe_transfer_id          â”‚
                  â”‚ evidence_urls               â”‚
                  â”‚ ...                         â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. Mobile UI Component Tree

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  MOBILE APP COMPONENT STRUCTURE                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

DriverApp
â”œâ”€â”€ DriverShipmentsScreen
â”‚   â”œâ”€â”€ ShipmentCard (status-based display)
â”‚   â””â”€â”€ FilterTabs
â”‚
â”œâ”€â”€ DriverShipmentDetailScreen
â”‚   â”œâ”€â”€ StatusBadge
â”‚   â”œâ”€â”€ ShipmentInfo
â”‚   â”œâ”€â”€ ActionButtons (status-based)
â”‚   â”‚   â”œâ”€â”€ "Start Trip" (if accepted)
â”‚   â”‚   â”œâ”€â”€ "I've Arrived" (if en_route)
â”‚   â”‚   â”œâ”€â”€ "Start Verification" (if arrived)
â”‚   â”‚   â”œâ”€â”€ "Mark Picked Up" (if verified)
â”‚   â”‚   â””â”€â”€ "Start Delivery" (if picked_up)
â”‚   â”œâ”€â”€ MapView (if en_route or in_transit)
â”‚   â””â”€â”€ ClientContactButtons
â”‚
â”œâ”€â”€ DriverPickupVerificationScreen â­ NEW
â”‚   â”œâ”€â”€ Header
â”‚   â”‚   â”œâ”€â”€ Progress: "3 of 6 photos"
â”‚   â”‚   â””â”€â”€ Timer (optional)
â”‚   â”œâ”€â”€ CameraView
â”‚   â”‚   â”œâ”€â”€ Camera preview
â”‚   â”‚   â”œâ”€â”€ Capture button
â”‚   â”‚   â””â”€â”€ Photo angle selector
â”‚   â”œâ”€â”€ PhotoGallery
â”‚   â”‚   â”œâ”€â”€ Thumbnail grid
â”‚   â”‚   â”œâ”€â”€ Required angles checklist
â”‚   â”‚   â””â”€â”€ "View comparison" button
â”‚   â”œâ”€â”€ ComparisonView â­ NEW
â”‚   â”‚   â”œâ”€â”€ Split screen
â”‚   â”‚   â”‚   â”œâ”€â”€ Client photo (left)
â”‚   â”‚   â”‚   â””â”€â”€ Driver photo (right)
â”‚   â”‚   â”œâ”€â”€ Angle selector tabs
â”‚   â”‚   â”œâ”€â”€ Zoom controls
â”‚   â”‚   â””â”€â”€ "Mark difference" button
â”‚   â”œâ”€â”€ DifferencesForm (if issues found)
â”‚   â”‚   â”œâ”€â”€ Difference type selector
â”‚   â”‚   â”œâ”€â”€ Severity (minor/major)
â”‚   â”‚   â”œâ”€â”€ Description textarea
â”‚   â”‚   â””â”€â”€ Affected area
â”‚   â”œâ”€â”€ DecisionSelector â­ NEW
â”‚   â”‚   â”œâ”€â”€ âœ… Matches card
â”‚   â”‚   â”œâ”€â”€ âš ï¸ Minor Differences card
â”‚   â”‚   â””â”€â”€ âŒ Major Issues card
â”‚   â””â”€â”€ SubmitButton (enabled if â‰¥6 photos)
â”‚
â””â”€â”€ VerificationStatusScreen
    â”œâ”€â”€ Status indicator
    â”œâ”€â”€ Client response wait (if minor)
    â””â”€â”€ Next steps instructions

ClientApp
â”œâ”€â”€ ClientShipmentsScreen
â”‚   â”œâ”€â”€ ShipmentCard
â”‚   â””â”€â”€ FilterTabs
â”‚
â”œâ”€â”€ ClientShipmentTrackingScreen
â”‚   â”œâ”€â”€ StatusTimeline
â”‚   â”œâ”€â”€ MapView (if driver en_route or in_transit)
â”‚   â”œâ”€â”€ ETADisplay
â”‚   â”œâ”€â”€ DriverInfoCard
â”‚   â”œâ”€â”€ ContactButtons
â”‚   â””â”€â”€ StatusSpecificViews
â”‚       â”œâ”€â”€ WaitingForDriver (if pending/accepted)
â”‚       â”œâ”€â”€ DriverEnRoute (if en_route)
â”‚       â”œâ”€â”€ DriverArrived (if arrived)
â”‚       â”œâ”€â”€ VerificationInProgress (if pending)
â”‚       â””â”€â”€ ReadyForPickup (if verified)
â”‚
â”œâ”€â”€ ClientPickupAlertModal â­ NEW
â”‚   â”œâ”€â”€ Header: "âš ï¸ Verification Issue"
â”‚   â”œâ”€â”€ ComparisonView
â”‚   â”‚   â”œâ”€â”€ Client photo
â”‚   â”‚   â”œâ”€â”€ Driver photo
â”‚   â”‚   â””â”€â”€ Swipe to compare angles
â”‚   â”œâ”€â”€ DifferencesList
â”‚   â”‚   â”œâ”€â”€ Issue type
â”‚   â”‚   â”œâ”€â”€ Severity badge
â”‚   â”‚   â”œâ”€â”€ Description
â”‚   â”‚   â””â”€â”€ Photos
â”‚   â”œâ”€â”€ CountdownTimer: "4:32 remaining"
â”‚   â”œâ”€â”€ RefundCalculator: "$350 (70%) if cancelled"
â”‚   â””â”€â”€ ActionButtons
â”‚       â”œâ”€â”€ "Approve Pickup" (green)
â”‚       â””â”€â”€ "Cancel & Get Refund" (red)
â”‚
â””â”€â”€ VerificationResultScreen
    â”œâ”€â”€ Result badge (âœ…/âš ï¸/âŒ)
    â”œâ”€â”€ Summary
    â””â”€â”€ Next steps
```

---

## 9. Notification Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     NOTIFICATION TRIGGERS                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Status Change Event
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Detect status    â”‚
â”‚ change in        â”‚
â”‚ database         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Get shipment data    â”‚
â”‚ â€¢ Client ID          â”‚
â”‚ â€¢ Driver ID          â”‚
â”‚ â€¢ Status             â”‚
â”‚ â€¢ Details            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Determine recipients        â”‚
â”‚ â€¢ Client? â†’ Most statuses   â”‚
â”‚ â€¢ Driver? â†’ Some statuses   â”‚
â”‚ â€¢ Admin? â†’ Fraud, issues    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Select notification channels         â”‚
â”‚                                      â”‚
â”‚ High Priority (SMS + Push + Email): â”‚
â”‚ â€¢ driver_arrived                     â”‚
â”‚ â€¢ minor_differences_found            â”‚
â”‚ â€¢ cancelled                          â”‚
â”‚                                      â”‚
â”‚ Medium Priority (Push + Email):      â”‚
â”‚ â€¢ accepted                           â”‚
â”‚ â€¢ driver_en_route                    â”‚
â”‚ â€¢ pickup_verified                    â”‚
â”‚ â€¢ picked_up                          â”‚
â”‚ â€¢ delivered                          â”‚
â”‚                                      â”‚
â”‚ Low Priority (Push only):            â”‚
â”‚ â€¢ pickup_verification_pending        â”‚
â”‚ â€¢ in_transit                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Send Push Notif    â”‚â”€â”€â”€â”€â–¶â”‚   Send SMS       â”‚â”€â”€â”€â”€â–¶â”‚  Send Email  â”‚
â”‚                      â”‚     â”‚  (if critical)   â”‚     â”‚  (if needed) â”‚
â”‚ â€¢ Title              â”‚     â”‚                  â”‚     â”‚              â”‚
â”‚ â€¢ Body               â”‚     â”‚ â€¢ Phone number   â”‚     â”‚ â€¢ Template   â”‚
â”‚ â€¢ Data payload       â”‚     â”‚ â€¢ Message        â”‚     â”‚ â€¢ Variables  â”‚
â”‚ â€¢ Badge count        â”‚     â”‚ â€¢ Link           â”‚     â”‚ â€¢ CTA button â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                            â”‚                        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚ Log notification â”‚
                            â”‚ in database      â”‚
                            â”‚ â€¢ Sent at        â”‚
                            â”‚ â€¢ Delivered      â”‚
                            â”‚ â€¢ Opened         â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Save these diagrams for reference during development!** ğŸ“Š
